# 《用纯Python手搓经典计算机视觉算法》开源教材

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## 📖 项目简介

&emsp;&emsp;《用纯 Python 手搓经典计算机视觉与深度学习系统》是一个**从零构建视觉算法与深度学习框架的开源教材项目**。  
本项目坚持一个核心理念：

> **不调用现成主流深度学习框架，而是亲手构建算法、自动求导系统与模型训练流程。**

项目从最基础的算法（KNN、线性分类器）出发，逐步过渡到神经网络、自动求导（Autograd）系统，最终实现卷积神经网络（CNN）以及现代生成模型（如 DDPM）。

&emsp;&emsp;本项目是 **23 级数科班《计算机视觉》课程大作业** 的成果，同时也是一次**与大语言模型（LLM）深度协作的软件工程实践**。在项目中，我们将 LLM 视为“虚拟的资深算法工程师与导师”，共同完成了算法设计、系统搭建、实验分析与文档撰写的完整流程。

> 本项目中的自动求导系统参考并基于 DeZero 框架进行了教学化改造。
> DeZero 由斋藤康毅提出，并采用 MIT License 发布。
> 本仓库代码仅用于学习与课程展示目的，无任何商业化用途。

---

## 🧭 学习路线与项目主线

本教材采用 **“算法主线 + 系统主线”** 的双线并行结构：

### 🔹 第一阶段：算法即公式（Algorithm as Formula）

> **目标：把数学公式完整地“翻译”为可运行的 Python 程序**

在这一阶段，我们使用 Python 与 NumPy，实现经典视觉与机器学习算法。你将学会：

- 如何从数学定义出发，逐行实现算法
- 如何手动推导并编码损失函数与梯度
- 如何分析算法的时间复杂度与数值稳定性
- 如何通过实验验证模型假设的适用范围

📘 对应章节：KNN / Softmax / Two-Layer NN

------

### 🔹 第二阶段：算法即计算图（Algorithm as Graph）

> **目标：让“求导”成为程序的一部分，而不是人脑的负担**

随着网络结构变深，手写反向传播会迅速变得不可维护。本阶段从这一“痛点”出发，引导构建一个最小可用的自动求导系统。你将学会：

- 如何将链式法则表达为程序结构
- 如何构建并遍历计算图
- Variable / Function 抽象背后的设计思想
- 自动求导系统如何解耦“模型结构”和“梯度计算”

📘 对应章节：Autograd / DeZero Core

------

### 🔹 第三阶段：模型即系统（Model as System）

> **目标能力：将复杂模型视为“可组合、可扩展的系统”**

在拥有自动求导能力后，模型的复杂度不再受限于人类手算。本阶段使用自制框架，逐步构建现代深度学习模型。你将学会：

- 将 CNN 拆解为可复用的模块（Conv / Pool / FC）
- 理解卷积神经网络为何适合图像数据
- 将模型训练视为“程序化优化过程”
- 从判别模型扩展到生成模型（DDPM）

📘 对应章节：CNN / Diffusion Models (DDPM)

---

## 📘 章节结构总览

```text
.
├── 01_knn/                    # K-近邻分类器（纯 NumPy）
├── 02_softmax/                # Softmax 线性分类器
├── 03_two_layer_nn/           # 两层全连接神经网络
│
├── 04_nailorch/               # 自动求导与计算图
│   ├── core/          		   # 核心实现
│   └── README.md
│
├── 05_cnn/                    # 卷积神经网络
│   ├── cnn_numpy/             # 纯 NumPy CNN
│   ├── cnn_dezero/            # 基于 DeZero 的 CNN
│   └── README.md
│
├── 06_diffusion_models/       # 现代生成模型
│   ├── ddpm/                  # DDPM 从数学到实现
│   └── README.md
│
└── README.md
```

## 第一阶段：经典算法与浅层模型（NumPy 实现）

### 第一章：K-近邻（KNN）分类器

- 核心思想、距离度量与 K 值选择
- 向量化距离计算与投票机制
- MNIST 数据集实验与可视化分析

| 实验               | 结果         |
| ------------------ | ------------ |
| MNIST 测试集准确率 | **94.63%**   |
| 数值稳定性测试     | 成功避免溢出 |
| 预测结果可视化     | 支持混淆矩阵 |

👉 详见：./01_knn/README.md

### 第二章：Softmax 线性分类器

- Softmax 函数与交叉熵损失
- 数值稳定技巧
- 完整训练与评估流程

| 实验               | 结果             |
| ------------------ | ---------------- |
| MNIST 测试集准确率 | **92.27%**       |
| 错误分析           | 明确易混淆数字对 |

👉 详见：02_softmax/README.md

------

### 第三章：两层全连接神经网络

- 前向传播与反向传播完整推导
- 非线性激活函数的作用
- 批量归一化与训练稳定性分析

| 实验         | 结果            |
| ------------ | --------------- |
| XOR 问题     | **100% 准确率** |
| MNIST 测试集 | **97.2%**       |

👉 详见：03_two_layer_nn/README.md

## 第二阶段：自动求导与 DeZero 框架

### 第四章：从反向传播到自动求导系统

  随着网络深度增加，手动维护梯度变得极其困难。本章从“反向传播的痛点”出发，引导读者一步步构建自动求导系统。

- 链式法则的程序化表达
- 计算图的构建与反向遍历
- Variable / Function 抽象
- DeZero 风格微型深度学习框架

👉 详见：04_autograd/README.md

## 第三阶段：现代深度学习模型

### 第五章：卷积神经网络（CNN）

本章采用 **双实现策略**：

1. **NumPy CNN**：理解卷积与池化的本质
2. **DeZero CNN**：体验现代深度学习的工程范式

| 实现方式   | MNIST 测试集准确率 |
| ---------- | ------------------ |
| NumPy CNN  | 约 98%             |
| DeZero CNN | **99.06%**         |

并提供：

- 训练曲线分析
- 混淆矩阵
- 卷积核与特征图可视化
- 高置信度错误分析

👉 详见：05_cnn/README.md

### 第六章：扩展 —— 扩散模型（DDPM）

- 正向扩散过程的数学定义
- 反向去噪建模思想
- 使用 UNet + MSE Loss 的训练方式
- 基于 DeZero 的 DDPM 实现与采样

本章目标不是复现 SOTA，而是证明：

> **自制框架同样能够承载现代生成模型**

👉 详见：[06_diffusion_models/README.md](06_diffusion_models/README.md)

## 🤖 与 LLM 的协作说明

  本项目完整记录了与大语言模型在以下方面的协作过程：

- 算法设计与推导
- 系统架构规划
- 代码调试与重构
- 实验分析与可视化
- 教材化文档撰写

各章节均提供对应的 **LLM 协作记录文档**，以供教学与研究参考。

## 👥 贡献团队

魏子钦
刘艺航
钦浩然
刘宇
李暄

------

## 📜 许可证

本项目采用 **MIT License**，可自由用于学习、教学与二次开发。
 详见 [LICENSE](./LICENSE)。